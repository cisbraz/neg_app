unit Parametro;

interface

uses
  Windows, Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, CadastroBase, Vcl.ComCtrls, Vcl.ToolWin,
  Vcl.StdCtrls, CurrencyEdit;

type
  TuFrmParametro = class(TuFrmBase)
    lblNomeProduto: TLabel;
    edtUrlAcessoNegociacao: TEdit;
    procedure btnExcluirClick(Sender: TObject);
    procedure btnGravarClick(Sender: TObject);
    procedure btnPesquisarClick(Sender: TObject);
    procedure btnCancelarClick(Sender: TObject);
    procedure btnFecharClick(Sender: TObject);
  private
    procedure Controle;
    { Private declarations }
  public
    { Public declarations }
  end;

var
  uFrmParametro: TuFrmParametro;

implementation

{$R *.dfm}

uses Funcoes, Persistencia, ModuloCadastro, cParametro;

procedure TuFrmParametro.btnCancelarClick(Sender: TObject);
begin
  if Questionar('Deseja realmente cancelar a edição!') then begin
     Controle;
  end;
end;

procedure TuFrmParametro.btnExcluirClick(Sender: TObject);
begin
  inherited;
  if (edtCodigo.Value > 0) then begin
    if Questionar('Deseja realmente excluir o registro?') then begin
      if (UsoProduto(edtCodigo.Value)) then begin
        Exclamar('Não é possível excluir produto, foi utilizado em negociação!');
        Exit;
      end;

      try
        Excluir('PRODUTO',
               ['PRODUTO_ID'],
               [edtCodigo.Value]);
        Informar('Excluido com sucesso!');
        Controle(False);
      except
        raise;
      end;
    end;
  end;
end;

procedure TuFrmParametro.btnFecharClick(Sender: TObject);
begin
    if Questionar('Deseja realmente cancelar a edição!') then begin
      inherited;
    end;
end;

procedure TuFrmParametro.btnGravarClick(Sender: TObject);
begin
  GravarParametro('TIPO_TAXA_MATRICULA', edtUrlAcessoNegociacao.Text);
  Informar('Gravado com sucesso!');
  Controle;
end;

procedure TuFrmParametro.btnPesquisarClick(Sender: TObject);
begin
  edtUrlAcessoNegociacao.Text := RetornaParametro('TIPO_TAXA_MATRICULA');
end;

procedure TuFrmParametro.Controle;
begin
  edtUrlAcessoNegociacao.Clear;
end;

end.
